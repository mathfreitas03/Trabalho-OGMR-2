<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Login - Gerenciador de Portas</title>

    <!-- Bootstrap 5 CSS -->
    <!-- Bootstrap local -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">

    <style>
      :root{
        --verde-escuro: #064e3b; /* cor prim√°ria: verde escuro */
        --verde-escuro-2: #063f33; /* hover */
        --fundo: #ffffff; /* branco */
      }

      html,body{
        height:100%;
        background: var(--fundo);
      }

      .login-container{
        min-height:100vh;
        display:flex;
        align-items:center;
        justify-content:center;
        padding:2rem;
      }

      .login-card{
        width:100%;
        max-width:420px;
        border: none;
        border-radius: 12px;
        box-shadow: 0 6px 30px rgba(6,78,59,0.12);
        overflow: hidden;
      }

      .login-card .brand-header{
        background: linear-gradient(180deg, var(--verde-escuro), var(--verde-escuro-2));
        color: #fff;
        padding: 1.6rem 1.25rem;
      }

      .brand-title{
        margin:0;
        font-weight:700;
        letter-spacing:0.2px;
        font-size:1.1rem;
      }

      .brand-sub{
        font-size:0.85rem;
        opacity:0.9;
      }

      .card-body{
        padding:1.6rem;
        background: #fff;
      }

      .form-control:focus{
        border-color: var(--verde-escuro);
        box-shadow: 0 0 0 0.15rem rgba(6,78,59,0.12);
      }

      .btn-primario{
        background: var(--verde-escuro);
        border-color: var(--verde-escuro);
      }
      .btn-primario:hover, .btn-primario:focus{
        background: var(--verde-escuro-2);
        border-color: var(--verde-escuro-2);
      }

      .divider{
        height:1px;
        background: #eef3f2;
        margin:1rem 0;
      }

      .small-muted{ color:#6b6f6b; font-size:0.9rem; }

      @media (max-width:420px){
        .login-card{ border-radius:10px; }
      }
    </style>
  </head>
  <body>

    <main class="login-container">
      <div class="card login-card">
        <div class="brand-header d-flex align-items-center">
          <div class="flex-grow-1">
            <h1 class="brand-title">Gerenciador de Portas F203</h1>
            <div class="brand-sub">Acesse sua conta</div>
          </div>
          <!-- √≠cone simples com SVG -->
          <div style="width:48px; height:48px; display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.06); border-radius:8px;">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden>
              <path d="M12 2C8.13 2 5 5.13 5 9c0 3.87 3.13 7 7 7s7-3.13 7-7c0-3.87-3.13-7-7-7zM12 12.5c-1.93 0-3.5-1.57-3.5-3.5S10.07 5.5 12 5.5s3.5 1.57 3.5 3.5S13.93 12.5 12 12.5zM4 20c0-3.31 2.69-6 6-6h4c3.31 0 6 2.69 6 6v1H4v-1z" fill="white" />
            </svg>
          </div>
        </div>

        <div class="card-body">
          <form id="loginForm" novalidate>
            <div class="mb-3">
              <label for="email" class="form-label">E‚Äëmail</label>
              <input type="email" class="form-control" id="email" required aria-describedby="emailHelp">
              <div class="invalid-feedback">
                Informe um e‚Äëmail v√°lido.
              </div>
            </div>

            <div class="mb-3 position-relative">
              <label for="password" class="form-label">Senha</label>
              <div class="input-group">
                <input type="password" class="form-control" id="password" placeholder="" required aria-describedby="togglePassword">
                <button class="btn btn-outline-secondary" type="button" id="togglePassword" aria-label="Mostrar senha">üëÅÔ∏è</button>
              </div>
              <div class="invalid-feedback">
                Informe a senha.
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mb-3">
              <button type="submit" class="btn btn-primario btn-lg text-light">Entrar</button>
            </div>
      </div>
    </main>

    <!-- Bootstrap JS (Popper inclu√≠do) -->
    <!-- Bootstrap JS local (ajuste o caminho se necess√°rio) -->
    <script src="js/bootstrap.bundle.min.js"></script>

    <script>
    const toggleBtn = document.getElementById('togglePassword');
    const pwd = document.getElementById('password');

    toggleBtn.addEventListener('click', () => {
      const type = pwd.getAttribute('type') === 'password' ? 'text' : 'password';
      pwd.setAttribute('type', type);
      toggleBtn.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
    });

    (function () {
    const form = document.getElementById('loginForm');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!form.checkValidity()) {
        form.classList.add('was-validated');
        return;
      }

      const data = {
        login: document.getElementById('email').value,
        password: document.getElementById('password').value,
      };

      try {
        const response = await fetch("http://localhost:5500/login.html", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        });

        if (!response.ok) {
          const result = await response.json();
          alert(result.error || "Falha ao realizar login");
          return;
        }

        window.location.href = "/main.html";

      } catch (err) {
        console.error("Erro na requisi√ß√£o:", err);
        alert("Erro ao conectar com o servidor");
      }
    });
  })();
  </script>
  </body>
</html>
